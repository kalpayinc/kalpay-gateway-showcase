!function(r){function t(){}var s=null;const i=()=>{(s=new WebSocket("wss://ws.invoice.kalpayinc.com")).onmessage=e=>{e=e.data;if(e){const t=JSON.parse(e),n=!!t.isTransactionComplete&&t.isTransactionComplete;r.superSDK.modal_rpc.completeTransactionCllbk(n,null),n?broadcast("PAYMENT_SUCCEEDED"):broadcast("PAYMENT_FAILED")}}};i();function n(){r.superSDK.easyXDM&&(r.superSDK.modal_rpc=new r.superSDK.easyXDM.Rpc({remote:"https://gateway.kalpayinc.com/",onReady:broadcast("IFRAME_CHECKOUT_LOADED"),container:"supersdk-container",props:{style:{opacity:"1",height:"100%",position:"relative",background:"none",display:"block",border:"0 none transparent",margin:"0px",padding:"0px","z-index":"2"},allowpaymentrequest:"true",allowtransparency:!0,width:"100%",height:"100%"}},{remote:{loadSettingsAndPayload:{},payment_status:{},initTransactionCllbk:{},completeTransactionCllbk:{}},local:{hideModal:a,proceedPayment:e,initTransaction:o,completeTransaction:p}}),r.superSDK.promoteSettings=function(e){r.superSDK.modal_rpc.loadSettingsAndPayload(r.superSDK.settings,r.superSDK.items,r.superSDK.operators,e)})}var e=function(e,t){r.superSDK.modal_rpc.payment_status("PAYMENT_PENDING"),scenario=t,setTimeout(()=>{broadcast(scenario),broadcast(e),r.superSDK.modal_rpc.payment_status(scenario)},1500*Math.random())},a=function(){var e=document.getElementById("supersdk-container");e&&(e.style.display="none");e=e&&e.getElementsByClassName("supersdk-backdrop")[0];e&&(e.style.background=null),broadcast("CHECKOUT_IFRAME_CLOSED")};t.prototype.ON_SITE="on_site",t.prototype.OFF_SITE="off_site",t.prototype.DEFAULT_BG_COLOR="#6926bf",t.prototype.MODAL_TEMPLATE='<div id="supersdk-container" style="z-index: 1000000000; position: fixed; top: 0px; display: none; left: 0px; height: 100%; width: 100%; backface-visibility: hidden; overflow-y: visible;"><div class="supersdk-backdrop" style="min-height: 100%; transition: all 0.3s ease-out 0s; position: fixed; top: 0px; left: 0px; width: 100%; height: 100%;"></div></div>';function c(e){t.script=$script.noConflict(),t.script("https://kalpay-gateway-resources.s3.us-east-2.amazonaws.com/v0/supersdk.templating.js",function(){var e;r.superSDK.templating&&(e=r.superSDK.templating.template(r.superSDK.MODAL_TEMPLATE)(),document.body.insertAdjacentHTML("beforeend",e))}),t.script("https://kalpay-gateway-resources.s3.us-east-2.amazonaws.com/v0/supersdk.rpc.js",function(){r.superSDK.easyXDM&&(r.superSDK.rpc=new r.superSDK.easyXDM.Rpc({remote:"https://services.kalpayinc.com/invoiceservice/tunnel/",onReady:broadcast("IFRAME_TUNNEL_LOADED")},{remote:{apiTunnel:{}}}),r.superSDK.api=function(e,t,n,o){var s=localStorage.getItem("supersdk.token");r.superSDK.rpc.apiTunnel(e,t,n,location.host,s,o)}),n(),r.superSDK.easyXDM&&(r.superSDK.app_rpc=new r.superSDK.easyXDM.Rpc({remote:"https://gateway.kalpayinc.com/",onReady:broadcast("APP_GATEWAY_LOADED")},{remote:{alertTest:{}}})),e()})}t.prototype.init=function(t,o){c(function(){var e=t,n=o;r.superSDK.api("/auth/login","POST",e,function(e){var t=e["data"];t?localStorage.setItem("supersdk.token",t.data):localStorage.removeItem("supersdk.token"),n(e)})}),t=t||{},this.settings={api_key:t.api_key||null,processMode:t.processMode||this.ON_SITE},this.items=[],this.operators=[],this.listen("CHECKOUT_IFRAME_CLOSED",function(){r.superSDK.modal_rpc.payment_status(""),r.superSDK.modal_rpc.destroy(),n()}),this.listen("PAYMENT_SUCCEEDED",function(){var e=r.superSDK;setTimeout(()=>{a(),e.settings.success_url&&(r.location=e.settings.success_url)},3e3)}),this.listen("PAYMENT_FAILED",function(){var e=r.superSDK;setTimeout(()=>{a(),e.settings.failed_url&&(r.location=e.settings.failed_url)},3e3)})},t.prototype.setup=function(e){e=e||{},this.settings={...this.settings,store_name:e.store_name||null,store_logo_url:e.store_logo_url||null,frame_color:e.frame_color||this.DEFAULT_BG_COLOR,triggerer:e.triggerer||null,taxes:e.taxes||[]}};var o=e=>{const o=localStorage.getItem("supersdk.invoice")?JSON.parse(localStorage.getItem("supersdk.invoice"))._id:null;e={payment:{...e,type:"Payment",currency:"xof"},invoiceId:o};r.superSDK.api("/transaction/init","POST",e,function(e){var{data:t,error:e}=e;if(t)r.superSDK.modal_rpc.initTransactionCllbk(!0,null),s&&(1===s.readyState?s.send(JSON.stringify({event:"invoice",data:o})):(i(),s.onopen=e=>{s.send(JSON.stringify({event:"invoice",data:o}))}));else{const n=JSON.parse(e);r.superSDK.modal_rpc.initTransactionCllbk(!1,n.message||n.data)}})},p=e=>{e={...e,invoiceId:localStorage.getItem("supersdk.invoice")?JSON.parse(localStorage.getItem("supersdk.invoice"))._id:null};r.superSDK.api("/transaction/complete","POST",e,function(e){var{data:t,error:e}=e;t?r.superSDK.modal_rpc.completeTransactionCllbk(!0,null):r.superSDK.modal_rpc.completeTransactionCllbk(!1,JSON.parse(e).data)})};t.prototype.proceed=function(e){!function(){var e=document.getElementById("supersdk-container");e&&(e.style.display="block");e=e&&e.getElementsByClassName("supersdk-backdrop")[0];e&&(e.style.background="rgba(0, 0, 0, 0.05)")}(),r.superSDK.promoteSettings(function(e){!function(){const t={items:[]};t.description=r.superSDK.settings.store_name+"'s invoice",t.source="Gateway",r.superSDK.items.map(e=>t.items.push({name:e.name,description:e.description||e.name,price:e.unit_price,quantity:e.quantity})),r.superSDK.api("/invoice","POST",t,function(e){var{data:t,error:e}=e;t?(broadcast("INVOICE_CREATED"),localStorage.setItem("supersdk.invoice",JSON.stringify(t.data))):(console.error(e),localStorage.removeItem("supersdk.invoice"))})}(),broadcast(e)})},t.prototype.setOperators=function(e){this.operators=["Kalpay",...e=e||[]]},t.prototype.addItem=function(e){this.items.push({name:(e=e||{}).name||null,description:e.description||null,unit_price:e.unit_price||0,quantity:e.quantity||0,item_photo:e.item_photo||null})},t.prototype.setNavigation=function(e){e=e||{},this.settings={...this.settings,success_url:e.success_url,failed_url:e.failed_url,back_url:e.back_url}};var u={};t.prototype.listen=function(e,t){void 0===u[e]&&(u[e]=[]),u[e].push(t)},t.prototype.unlisten=function(t,e){if(u[t])for(let e=0;e<u[t].length;e++){u[t][e].splice(e,1);break}},broadcast=function(t){if(u[t])for(let e=0;e<u[t].length;e++)(0,u[t][e])()};var l=r.superSDK;t.prototype.noConflict=function(){return r.superSDK=l,new t},r.superSDK=new t}(window),function(e){"function"==typeof define?define(e):"undefined"!=typeof module?module.exports=e():this.$script=e()}(function(){var p,e=this,s=document,r=s.getElementsByTagName("head")[0],u=/^https?:\/\//,t=e.$script,l={},d={},m={},f={},i=!1,y="push",a="readyState",c="onreadystatechange";function S(e,t,n){for(n=0,j=e.length;n<j;++n)if(!t(e[n]))return i;return 1}function g(e,t){S(e,function(e){return!t(e)})}function _(e,t,n){e=e[y]?e:[e];var o=t&&t.call,s=o?t:n,r=o?e.join(""):t,i=e.length;function a(e){return e.call?e():l[e]}function c(){if(!--i)for(var e in l[r]=1,s&&s(),m)S(e.split("|"),a)&&!g(m[e],a)&&(m[e]=[])}return setTimeout(function(){g(e,function(e){return f[e]?(r&&(d[r]=1),2==f[e]&&c()):(f[e]=1,r&&(d[r]=1),void D(!u.test(e)&&p?p+e+".js":e,c))})},0),_}function D(e,t){var n=s.createElement("script"),o=i;n.onload=n.onerror=n[c]=function(){n[a]&&!/^c|loade/.test(n[a])||o||(n.onload=n[c]=null,o=1,f[e]=2,t())},n.async=1,n.src=e,r.insertBefore(n,r.firstChild)}return!s[a]&&s.addEventListener&&(s.addEventListener("DOMContentLoaded",function e(){s.removeEventListener("DOMContentLoaded",e,i),s[a]="complete"},i),s[a]="loading"),_.get=D,_.order=function(n,o,s){!function e(t){t=n.shift(),n.length?_(t,e):_(t,o,s)}()},_.path=function(e){p=e},_.ready=function(e,t,n){e=e[y]?e:[e];var o=[];return g(e,function(e){l[e]||o[y](e)}),S(e,function(e){return l[e]})?t():(e=e.join("|"),m[e]=m[e]||[],m[e][y](t),n&&n(o)),_},_.noConflict=function(){return e.$script=t,this},_}),"function"==typeof window.superSDK_Async&&window.superSDK_Async();